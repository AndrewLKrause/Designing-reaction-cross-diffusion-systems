# Code Overview
 
This is the repository of code associated with the paper, "Designing large reaction-cross-diffusion systems with Turing and wave instabilities." The key files to use are RunAndPlot.m and the associated plotting functions. An example of this would be calling:

`[U, x, T, ui, vi] = RunAndPlot('KellerSegelWaveNeumann',1);`

which will run the Keller-Segel chemotaxis model using the standard parameters in one spatial dimension with homogeneous Neumann boundary conditions, and then plot a Kymograph of the variable $u$. A full list of presets with parameters can be found in the file RunSIm.m, and any of them can be modified. Note that all but the KellerSegel simulations will also work in 2 spatial dimensions for the given parameters, though some of the models will not converge for all values of the parameters in both 1D and 2D.

## Numerical methods

For all models, a simple central finite differencing method is used to discretize the spatial operators. 

In all 1D simulations we used $m=1000$ nodes, and for the 2D simulations we used $m=100^2$ nodes. In all of these cases, the spatially-discretized system is then fed into the MATLAB function `ode15s` which implements a stiff implicit timestepping scheme, with default relative and absolute tolerances set to $10^{-9}$. For the local models, Jacobian sparsity patterns are used to massively reduce simulation times, though this is not useful for the nonlocal model which generically has a fully-coupled system of ODEs after spatial discretization. Convergence checks were carried out in space and time for the standard parameters of each model.

## Interactive solutions

An interactive live-simulation implementation of the three local models can be found on the VisualPDE website at https://visualpde.com. Specific URLs for each are:

[Keller-Segel](https://visualpde.com/sim/?options=N4IgRgqiBcIHYFMCuBbAhnOIA04BqM8y6mO4A6oYqhlrmAE6ECsAdAGwAM3PvvzZMADdCAJQCCAOQAiZAMazoAFwZIEuACYQosDWS0FYAWgBMAKjRmkAegAUARgDUSAHomAlPryGQ9-eUpYP00AZ0J7Tn0lGE5Wflw5HV9HWM5mMwkZSTIAa0INAAIAXgL7VnsAbjRigoBmCrACmoKADgq5JpK62tYAdmYKhE6mo2Z7E1YBgDNhgtHuCoBzWaNYgBZ7AE4TEwqAC1mxieZe3oqAS0OFhAAHEPOAGwB7OBrUyrJ0QmPP88JU7hrFomCLMTibXqcWprTZrdjBeAwWq4G6EADCSBCSieKDINwYTzACAAYkgsLAkHiCUSADIIOCLJR7GD2MG4BhJMBWMwOIxITzsnxyKyOBBmISOKZmADuRlu92ecHFLlqZAYgRAixFe3FjnOMrld0eLxlKrIIVRsFSJnN5JASAKQgK0vNlOUqnUIBE0AA2qA0AwCdK0U9nkgmNB2MxmLVmLgA0HpPT7koAJ4xSbxwNPaV0hlMgCyaAAHuEyAmcwBlORoB4IQhoJDY8vZ6UADUINIA+sXrCY5gVS1mgwBNTtd1N9gfp+NNp6VhBKENhhiiDCLevQKa1kKemsoBAMNAAFT2i7QSM4CTQB6PAAU9n9oLUryB94e0AAtJ44jMtBKhk84boJaIBKOGYBPPIgEQQGMDbg8u4AXA2LhmEW47nuLyoQwy5ARGr5yNh+EAKJGoqGacPYyE4ZIqAwHGb6YtiKCVuG25yJuCFISACAoJBIToSoai4HxAkhOI-HnPS0TQLEjFiU8gnSOcUxTJim6xOwon8UpIQPk+ZQnJw-68bpgmVo+cDptAEQ6eJlYoD+TKIIJGYmPZemVjcCByEgDxwXJrAeWZ4mnueGa9C0zBrLgUwPOcNw+RoeHAWglrcZ6CWIOQ5waIW-ksrg6DFqlDB4LWajfJMvxwGVFUPFVVpxICwKguCkLQrC8JkE8QiHgFNmZbgfUDWgqZlTEI39Qwg1kQqLyUWk01jamJHFviZYrbN400ucOV5QVDxFSANzPEox6pj5hBnRg9YotS+2LPBmEPYSJJkoQlJvbS9KMsytlsqd1IIJd12wPtSgIIsR7HT9CAdlaVLvWOSO4CE7FoJxpJ2pEuBMgwCAINIAASCDnIsexKNWtaaX0uD9XI2IMMS0kPHoGGIZ60p7GgF1PHe51fWQcA3puvggAAvgAurg0oc-aZDSqB30gPcKDHucSh1oQADSCAPHWDCAMgEC4bsdktAA)

[Schnakenberg](https://visualpde.com/sim/?options=N4IgRgqiBcIHYFMCuBbAhnOIA04BqM8y6mO4A6oYqhlrmAE6EBMZAxoQDZoBuaAZpwD2Ad3YARGABcGSBLgAmEKLAUJOUtGQV4VINRrQBaAIza8BWGcV5KVgJwAOAFQAKE0YOaAlNvJ39dU1tAGcWAAZtKRhwgDpwhJNcBGlZeRAEAAUY2PtkgGUUHIBmXDY9NAACAGpKsGq48IBWZwAlAEEAOXFO9ktwSoB6Stc0arBvAD1WMoCxsDIAa0IqyoBeSsqTAG4wTY3KuKbtrzQ1uIA2bbJ0QkcbgEtCSNwsWGKyOAAVGGYE3AADoQAMJIEJSIRFQEMIRgBAAMSQbxASDIAJhcIAMgg4ABzKQACxgxXCuAYFUqRkqSBqSGmzh4ZAY-T2VLpzAZTICSCMYlwISBsEaTTIIWRNJ4lT5IEZ0AA2qA0AwYSJgUJhEgmNALk0msUmrglSrxDiQg8pABPHIGkBG0TYvGEgCyaAAHoRrLblaJ8mw0JwUrA0EgIWQ7SIABqETEAfVdg2YlMq7sN3pEAE1ozGLQmk1bDSGhPkEFI1RqGK0MLjA-x-SF0n6UAgGGgvgSS1poCSymgmy3MgSnl3SSBG820AAtISQnKOMrqoSa9CCkDcPiCUTsBeasBKmC1zj1+dwCGasLQA9H0dCE+Lhhlu8xY+nhgAUQBZuEb0aSWvt81nSoDANpsGCEIoPkmq1mwNZ1ukCAoGAQghOeMhyMkiHISE7SIQ8OLRNARwYUhKHiA8-D8GCgaXMRWEDkOcR5BkmEofkg5wFa0AmCOCEkSEhTToSiAoSUtGsQCCCgdwWpxMwYkhG2HY5AA7I4TQACy4IIDwAhJCgPkuaCCpe6ScA8iDkA8CjOkgnAwL+6CugZzL+nIdyPHAzl4K5gYgC8IBCDwzbcJxJm4IFwVoBazlPgFQUMCF76fjeOQJDaEUJVFr6uuiHpkBlIWYuZCCWdZBJOrZ9mAsIUhfBaEmEAC3CIGiGLmbi+5wdCsIIkihCot1WI4viRLDoNCB1Q1sDmVICC4i2dnjVGQqtT1mYrfyUFoDBiLIv5hIMAgCDiAAEggDy4gSUi+v61GxMpuBBWwEIMPCeGcAonWHukIgEmgtVCJkNX9Z8va+WYAC+AC6uAiJ9sADSAIgrojZooF85oBoQvoEnAaCLDicIMB1ENAA)

[Malaria model](https://visualpde.com/sim/?options=N4IghiBcAuBOCuBTANCARgVSiAdo+AtmDjiKmgGrZ6HGnkDq1+RJZ6s2ArAHQBsABiHCRIruzQA3bACUAggDkAIuwDGaKHCSpVKmAhQgAJhiyQQARnYmq5gBQAmAFQAJAPqSA9C4DOPgJSedhYA1HbuXr4BAHoO-k4CPOKoJkz2zhHefoHBYZlR-rHxiQDMAgDsDg7JxhRmII5OAJKeTdlBoXYtbTFxCTwAHOUCJQAsA9YUtpbWDGnGiAA20BApPtgWAtbQUInCDjr1UU65eyVO8soK-mrTPSehZxeKStdq8wAKfg8hT5evN1QAGtsGgAARggC8EMSFgA3Gg3C4IdCwfCjEiUTCePDEQBZLFouEYglQ7ElOGqQmJapw2DUpJwgCKhM2AjhUUJGJcThJJ25IVgOTQ-KRJ1UTiZIQFQoAtIieXYZf4VXCeoTjnYFbLuYFuXCvj5CVqkTqkfElUjBTkJbriUsVgyBKMuHD2ERsDSqg4BnwHCUAJwOPh8QNcLjld0AS09PAEDlGDgso3KXADoz4AZGVQGE1QpEgJXzABUoGyBKgAPYAMWwH3YAAdsABheA+aCVgiN2CVtCIavwAsgCLd3uIAAyiBwAHNoAALMtcCsgWD1E0uM0ueIRWUSj6uDyC5rsWDTTfNMEhMF7g+SMGy2DH1CweZmvFOD4hEV2Jmyj7xJp2B8RBoAAZUQRAjE0AxUB8OdKwAd1AlZoHWfRtBAHwm3MPZRiAocIjBJowXrWD4GgjDoCg9DDGkSAAG1QDAWAewQ5tK0WSt4E4SA+HDEouFQZjWKUKcfCjaAAE9diSISWMQycZ3nPEwAADw2dhhMQ0DVDARZEGwMB4A7TT5IQgANbBxzcVTPAce8wXUuTWIATSstxJLshzpKE4zK3A6B2M47iZGIacDJonQwAIRBYDAYs5xAiBC2XXSYrij45xjFKovSsAAC1K07GSBh0DiuNgIhsJAaBuLQSs1HKurmIowxVErHAO24tCADM9OAsrOoqoKKt2QautgABRBtxM4gs9gscaKoUQgoEEkBVDbDsCFA7i+tUCK+sWAaQEQAh6r8KAjpOs6Lp8ORzqjKcdkgRJ1tuys-CUKMep6tsIsSPhUA+vxMuyiwkmGUrTvOz6fFArKcGkyBNmB2G-FAggivnPBLtengDhhu7QIbRBNsWFr8cJkGfASpKZPKAYuFGVAesWKMG1JowRu4qqrv6wx2bwBgoyMZT4EWMtUCIVSedPPSkFjCpoxwOWKAViKQC2KtJFiinkeuwxK112B9blsaQGNvWwEk6bZo6mShHWq3TZtybVIbHiQFIy2Tf18co2F0XxcllHUAbTjoGLSTSewCPiAM8OezQQPp3547DE9scBwIjxRz7RTZwXFGlyTsdo9j8xA+gRBpziyWy77SycPzxA3JbsjYH2-tB09dh51gCClBcRAo2nOcwN0-SGdQXXVA7WBqyexZqMN1AELnMAo8rD5I+wEd82izWrAAX2QJizPN3j+PWrSENEnBxKkmTb7MwvlLUjTnO0qfNaMkzv4WXcrZeyspHKmVcu5TyoCwQ+XAH5AKctQozgiloNqR84p0xWFAMouVYpgDBjg1KGCCpFS7PjaG7VgqVTANVWqsB6qNWoWgSmaClrdXTiddqQ1uJX1Sh1CadsoxzUdotDaAjlqrUgOtTa7ZOy7S7mAA6nDDA0xUWjO6D0U7PRfhouG31fr-RkkDImcNCEo0hgIaGNMEaB2RqjUxGMsaVhxogPGNI9EY1JuTSmHjHG00Stg-GjNmas3ZpzSCcs+aQDXiAIWiARZiznHiCWUsQAyzVhrDYfAVaZMWIrDuvtrYGwFjrYpfCymu1tjNYRDt8ZO0qfrd2ns6zsBdv7QOCTg7JNSWHEAEcXEV01vHPA+dU7qP6cnHuudpCNwnFOIui5lxZz7EM7A1da711bs3LWrd267M7t3HOfdUADyHiPMeE8dJ6QBjwcos8yYLyXksVepSQAby3sWHee9zCAUPjFKADgz4X1YlfPiXABKAIfk-ZGb1AHv2SZ-cwVhAHXOnuYf+DVAE7OsiAhyTlwBmX2dZaB3lNIIJAkgsKqCYIbRIVg5KuC6V5XMUytK+DCrFQoWVah0Sap1SxeI5hrDaXcImr1N5YrhpNR4vwnhU0akiPqWIqV3EVrkJkVteRe0lGHTeWomJ+r0b3Uejo-G71jUGL+sBYxnifDmIhhGKxdrbFIzLMuGxzjXHuIJi67xEtfG+v8QyhmTMWYgDZhzLmUTaETPiYkkOaSMkyvVvk4+OTpaBzyQUg5RSqkTPaTbCpeammKrqXsAQzs-Zuw9l7H2hbJIByDkklJocxEDKjjHYZFNRmN3GYajOczjnmAPpMscCKllzLWVXTqmy9LbJOWOvs+ztaYR1QdYduazmIGHqPcek8bkzxAHPJ5y9XmDveZvbeu8XGtP+RFEoJ8AC669qLDjzuvaqo7xIEGLBJdFIAADSSx9KwEAMgE4FwqSxPkAA)

[Hyperbolic model](https://visualpde.com/sim/?options=N4IgRgTiBcIEwgDQgC5hiAbgGwJYDsBTJcTDAZhIGN1oUIBXQ5KjbAQ03YDNsB7AO7UAIjHpNkAEwCq0jJMLYU7EpIBqa+YuWqA6nNiSAjEYD0yhns2Gjcc+0tTdujEdUBFAyElwzFj9becHb+Uu7urqq4kVIAzhQADKooMAkAdAmZAKzIhAAKqWkAnLkAygC2heRlAA6FAGwsXgyxsQBUABRGANQABOkJWW0ASgCCAHLC4wCU1IGYrZ09A0NjkzMkANZaSuy9vQC8+0ZpWQm2ANx7h-vpcFlFF2D7R-3FABwXxkYv+wC0Ri+tl+vQBX18IIS4LgIL+cAuFkhaUB4xBXX++3IbXY0wAenBsbj6p0sexOnAAOzYtpgfEY3oAFmm3SZFwAsmiiks-qTpoSGTTurEAI4QFAdGZ4rqmcjTC4tWJojpwXHS2V8tl03p9XrE9i48j0gn6uDTUwdLEq5UyvkmtpsuULRU3XodMB-BVmi3YuUkcoqWBwNKUZDlaKwOHBkj4GAM5D4AAqMDgmWQNSTsDwRBIdVgAGEWig+JU0xA+GBCAAxBgx2COEA1MsVgAyhHwAHMUAALGDkBLICBeIQDwLCkgQFywDoMUG9MkMA3a3qYWfPP69ARm0IgCARKdr3oz9ektor9fCrcOEixQgoUqEQiSMSMZggWK5kDpNzIMjQADaoDsBAZYCHmfD8AwUDQPUWRZOQOQgEBIHCG2sS4CgACehQIUhgith23ZsuwAAeMSIcBgilFQ7DYMQsAOEWJC4QIAAaGDNgA+sRpgwuupHIMxACa7EcRhPGzlhAkMEW94oGBEEQMM7AdnR3A0TeLDsOUhAQOwCZdreAZ9pp2m6XkXbhsZIDUaZ7AAFp8MWhTvCw4F8JB-ofhwXC8II1BuZBYBAc+EjWXw+BFpB8TQGp2AaWFEXuRA8lJakrmJZBACiNRofwtYDEY6WRRA4wMJU0AIVQhbFqUkFqVQqnqa+hDlGAfCtDAsXxS1bWtKMrW4G2KTQOkCE9e1sTCLg3DcC0dHpI0IDja05nhukJRLa1E2lBZ+BYdARj9ptvWxBUjndkQHUjcGuRba0pQ1IQVUcFBC23Sd+mGYUFLvFkcYgLwuA1I9kgpR57C5l1r5ZoQui4JIhEMNgMCFSA-rEWDEBqDRTAYEGIZowQmPY9guMRvjJB8JgOkcPtUPIFTNPsBhmNpSAjMQLT2W5eFhTZAz1Oc8zmXEY2ZEc7TzYELD8OI8jB1pvwKAJhhj1sNLOZNgQ7adU1pbllWNYYPWjYG-hnY9tAVmmxWKtq7ABAoIQ7a6cj+sVmxsBJO7hDCV7151ewDXVrWn4kN2EAPsIAAShC4O2XZ3tRtHfT+T1FhAlaDdgT4xXrIACF27DK3weRK8b0ZaXRIBuAAvgAusgAi5yA9YCB+9ZoeUCboSnsAJpB2sbpwhCKgQvTdoQvSVtHqLlHwCjI7XQA)